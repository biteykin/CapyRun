import streamlit as st
from utils import open_sidebar, set_auth_mode

def _switch_and_focus(mode: str, toast_icon: str):
    # 1) —Å—Ç–∞–≤–∏–º –∂–µ–ª–∞–µ–º—ã–π —Ä–µ–∂–∏–º
    set_auth_mode(mode)
    # 2) –ø–æ–º–µ—á–∞–µ–º, —á—Ç–æ –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏ —Ä–µ–∂–∏–º –∏–∑–≤–Ω–µ
    st.session_state["_just_switched_auth"] = True
    # 3) —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º —Å–∞–π–¥–±–∞—Ä
    open_sidebar()
    # 4) –ø–æ–¥—Å–∫–∞–∑–∫–∞
    st.toast("–§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚Äî –≤ —Å–∞–π–¥–±–∞—Ä–µ —Å–ª–µ–≤–∞ üëà", icon=toast_icon)
    # 5) —Ñ–æ—Ä—Å–∏—Ä—É–µ–º –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É, —á—Ç–æ–±—ã —Ä–∞–¥–∏–æ –≤ —Å–∞–π–¥–±–∞—Ä–µ –æ—Ç–æ–±—Ä–∞–∑–∏–ª–æ –Ω—É–∂–Ω—ã–π —Ä–µ–∂–∏–º
    st.experimental_rerun()

def render_landing() -> None:
    st.markdown("# CapyRun ‚Äî AI-—Ç—Ä–µ–Ω–µ—Ä –¥–ª—è –±–µ–≥–∞ –∏ —Ñ–∏—Ç–Ω–µ—Å–∞ üß†üèÉ‚Äç‚ôÇÔ∏è")
    st.markdown(
        "–û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —Å–º–æ—Ç—Ä–∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –ø–æ–ª—É—á–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã, "
        "–∫–∞–∫ —Å—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–µ–µ."
    )

    st.markdown("### –ß—Ç–æ —É–º–µ–µ—Ç CapyRun")
    st.markdown(
        "- üìà –ì—Ä–∞—Ñ–∏–∫–∏ —Ç–µ–º–ø–∞, –ø—É–ª—å—Å–∞ –∏ –∑–æ–Ω ‚Äî –±–µ–∑ –≤–æ–¥—ã, —Ç–æ–ª—å–∫–æ —Å—É—Ç—å.\n"
        "- üß≠ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–≤–æ–∏–º –¥–∞–Ω–Ω—ã–º ‚Äî —á—Ç–æ —É–ª—É—á—à–∏—Ç—å —É–∂–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–±–µ–≥–µ.\n"
        "- ‚ù§Ô∏è –ó–æ–Ω—ã –ß–°–°: –∞–≤—Ç–æ—Ä–∞—Å—á—ë—Ç –∏ —Ä–∞–∑–±–æ—Ä, –≥–¥–µ —Ç—ã ¬´–∂—ë–≥¬ª, –∞ –≥–¥–µ ¬´—Ä–∞–±–æ—Ç–∞–ª –±–∞–∑—É¬ª.\n"
        "- üéØ –¶–µ–ª–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å: –≤–∏–¥–Ω–æ —Ä–æ—Å—Ç –∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞.\n"
        "- ‚öôÔ∏è –ò–º–ø–æ—Ä—Ç `.fit`: –∑–∞–≥—Ä—É–∑–∏ ‚Äî –∏ –ø–æ–ª—É—á–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∑–∞ –º–∏–Ω—É—Ç—ã.\n"
        "- üîí –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ Supabase."
    )

    col1, col2 = st.columns([1, 1])
    with col1:
        if st.button("üîë –í–æ–π—Ç–∏", use_container_width=True, key="btn_landing_login"):
            _switch_and_focus("login", "üîë")
    with col2:
        if st.button("‚ú® –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è", use_container_width=True, key="btn_landing_signup"):
            _switch_and_focus("signup", "‚ú®")

    st.caption("–§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚Äî –≤ —Å–∞–π–¥–±–∞—Ä–µ —Å–ª–µ–≤–∞ üëà")
